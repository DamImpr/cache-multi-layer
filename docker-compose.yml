services:
  test-sw:
    build: 
      context: .
    volumes:
      - ./app/src:/app/src
      - ./app/tests:/app/tests
    command: ./vendor/bin/phpunit ./tests/ 
    networks:
      - redis-network
    depends_on:
      redis-server:
        condition: service_started
  update-vendor:
    build:
      context: .
    volumes:
      - ./app:/app
    command: composer update --no-interaction --no-scripts --no-autoloader --prefer-dist  
  rector:
    build:
      context: .
    volumes:
      - ./app:/app
    command: php vendor/bin/rector process
  redis-server:
    image: redis
    ports:
      - 6379:6379
    networks:
      - redis-network
networks:
   redis-network:
    